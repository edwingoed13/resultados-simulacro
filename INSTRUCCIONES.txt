========================================
INSTRUCCIONES DE CONFIGURACI√ìN
Sistema de Consulta de Resultados
========================================

PASO 1: SUBIR TU EXCEL A GOOGLE SHEETS
----------------------------------------
1. Ve a Google Drive (https://drive.google.com)
2. Click en "Nuevo" > "Subir archivo"
3. Selecciona tu archivo Excel
4. Una vez subido, haz click derecho > "Abrir con" > "Google Sheets"
5. Aseg√∫rate que tu hoja tenga estas columnas en este orden:
   - Columna A: DNI
   - Columna B: Apellidos y Nombres
   - Columna C: Puntaje
   - Columna D: Area


PASO 2: CREAR EL GOOGLE APPS SCRIPT (API)
------------------------------------------
1. En tu Google Sheet, ve a "Extensiones" > "Apps Script"
2. Borra todo el c√≥digo que aparece
3. Copia y pega el siguiente c√≥digo:

------- COPIAR DESDE AQU√ç -------

function doGet(e) {
  try {
    const dni = e.parameter.dni;

    if (!dni) {
      return respuesta(false, 'DNI no proporcionado');
    }

    const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Hoja 1');

    // Si tu hoja tiene otro nombre, c√°mbialo arriba (por ejemplo: 'Resultados')

    if (!sheet) {
      return respuesta(false, 'Hoja no encontrada');
    }

    const data = sheet.getDataRange().getValues();

    // Buscar el DNI (empezamos desde 1 para saltar el encabezado)
    for (let i = 1; i < data.length; i++) {
      const row = data[i];

      // Convertir DNI a string para comparar
      if (String(row[0]).trim() === String(dni).trim()) {
        return respuesta(true, 'Resultado encontrado', {
          dni: row[0],
          nombre: row[1],
          puntaje: row[2],
          area: row[3]
        });
      }
    }

    return respuesta(false, 'No se encontraron resultados para este DNI');

  } catch (error) {
    return respuesta(false, 'Error en el servidor: ' + error.toString());
  }
}

function respuesta(success, message, data = null) {
  const output = {
    success: success,
    message: message
  };

  if (data) {
    output.data = data;
  }

  return ContentService
    .createTextOutput(JSON.stringify(output))
    .setMimeType(ContentService.MimeType.JSON);
}

------- HASTA AQU√ç -------

4. Click en el icono de "Guardar proyecto" (üíæ)
5. Ponle un nombre al proyecto, por ejemplo: "API Resultados"


PASO 3: IMPLEMENTAR LA API
---------------------------
1. Click en "Implementar" > "Nueva implementaci√≥n"
2. Click en el √≠cono de engranaje ‚öôÔ∏è junto a "Seleccionar tipo"
3. Selecciona "Aplicaci√≥n web"
4. Configura as√≠:
   - Descripci√≥n: "API de consulta de resultados"
   - Ejecutar como: "Yo"
   - Qui√©n tiene acceso: "Cualquier usuario"
5. Click en "Implementar"
6. Autoriza los permisos cuando te lo pida
7. **IMPORTANTE**: Copia la URL que aparece (es la URL de tu API)
   Se ver√° algo as√≠: https://script.google.com/macros/s/AKfycby.../exec


PASO 4: CONFIGURAR EL ARCHIVO script.js
----------------------------------------
1. Abre el archivo script.js
2. En la l√≠nea 2, reemplaza 'TU_URL_DE_GOOGLE_APPS_SCRIPT_AQUI' con la URL que copiaste
3. Debe quedar as√≠:
   const API_URL = 'https://script.google.com/macros/s/AKfycby.../exec';
4. Guarda el archivo


PASO 5: PROBAR LA APLICACI√ìN
-----------------------------
1. Abre el archivo index.html en tu navegador
2. Ingresa un DNI de prueba (por ejemplo: 60175412)
3. Click en "Consultar"
4. Deber√≠an aparecer los resultados


IMPORTANTE - ACTUALIZAR DATOS:
-------------------------------
Cuando recibas un nuevo Excel:
1. Abre tu Google Sheet
2. Borra todo el contenido anterior (Ctrl+A > Suprimir)
3. Copia los datos del nuevo Excel
4. Pega en Google Sheets (Ctrl+V)
5. ¬°Listo! Los datos se actualizar√°n autom√°ticamente


SOLUCI√ìN DE PROBLEMAS:
----------------------
‚ùå Error "Hoja no encontrada":
   ‚Üí Verifica que el nombre de la hoja en el c√≥digo coincida con el nombre real
   ‚Üí En el c√≥digo Apps Script, cambia 'Hoja 1' por el nombre correcto

‚ùå No aparecen resultados:
   ‚Üí Verifica que el DNI est√© en la columna A
   ‚Üí Verifica que no haya espacios extra en los DNI del Excel

‚ùå Error de CORS:
   ‚Üí Aseg√∫rate que en "Qui√©n tiene acceso" seleccionaste "Cualquier usuario"

‚ùå La URL no funciona:
   ‚Üí Aseg√∫rate de copiar la URL completa que termina en /exec
   ‚Üí No copies la URL de desarrollo, copia la de implementaci√≥n


SEGURIDAD:
----------
‚úì Los datos NUNCA se descargan al navegador completos
‚úì Solo se env√≠a el resultado del DNI consultado
‚úì Aunque inspeccionen el c√≥digo, NO ver√°n otros datos
‚úì Google Sheets permanece privado (solo t√∫ tienes acceso)


¬øNECESITAS AYUDA?
-----------------
Si algo no funciona, verifica paso por paso estas instrucciones.
